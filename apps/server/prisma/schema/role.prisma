model Role {
    id        String    @id @default(cuid())
    name      Roles     @default(USER)
    createdAt DateTime  @default(now())
    updatedAt DateTime? @updatedAt @db.Timestamptz(6)
    deletedAt DateTime? @db.Timestamptz(6)
    tenancies Tenancy[]
    abilities Ability[]
}

model Subject {
    id        String    @id @default(cuid())
    name      String    @unique
    createdAt DateTime  @default(now())
    updatedAt DateTime? @updatedAt @db.Timestamptz(6)
    deletedAt DateTime? @db.Timestamptz(6)
    abilities Ability[]
}

model Ability {
    id          String         @id @default(cuid())
    type        AbilityTypes
    roleId      String
    action      AbilityActions
    subjectId   String
    description String?
    conditions  Json?          @db.JsonB()
    createdAt   DateTime       @default(now()) @db.Timestamptz(6)
    updatedAt   DateTime?      @updatedAt @db.Timestamptz(6)
    deletedAt   DateTime?      @db.Timestamptz(6)
    subject     Subject        @relation(fields: [subjectId], references: [id])
    role        Role           @relation(fields: [roleId], references: [id])
}

enum AbilityActions {
    CREATE
    READ
    UPDATE
    DELETE
    ACCESS
}

enum AbilityTypes {
    CAN
    CAN_NOT
}

enum Roles {
    USER
    SUPER_ADMIN
}
