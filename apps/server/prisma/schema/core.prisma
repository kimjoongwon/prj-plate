model Category {
  id              String           @id @default(uuid())
  seq             Int              @unique @default(autoincrement())
  createdAt       DateTime         @default(now()) @db.Timestamptz(6)
  updatedAt       DateTime?        @updatedAt @db.Timestamptz(6)
  removedAt       DateTime?        @db.Timestamptz(6)
  name            String           @unique
  type            CategoryTypes    @default(ROOT)
  parentId        String?
  serviceId       String
  tenantId        String
  parent          Category?        @relation("CategoryToCategory", fields: [parentId], references: [id])
  children        Category[]       @relation("CategoryToCategory")
  service         Service          @relation(fields: [serviceId], references: [id])
  tenant          Tenant           @relation(fields: [tenantId], references: [id])
  classifications Classification[]
}

model Classification {
  id         String    @id @default(uuid())
  seq        Int       @unique @default(autoincrement())
  categoryId String
  userId     String?   @unique
  spaceId    String?   @unique
  roleId     String?   @unique
  fileId     String?   @unique
  timelineId String?   @unique
  createdAt  DateTime  @default(now())
  updatedAt  DateTime? @updatedAt @db.Timestamptz(6)
  removedAt  DateTime? @db.Timestamptz(6)
  taskId     String?   @unique
  category   Category  @relation(fields: [categoryId], references: [id])
  file       File?     @relation(fields: [fileId], references: [id])
  role       Role?     @relation(fields: [roleId], references: [id])
  space      Space?    @relation(fields: [spaceId], references: [id])
  task       Task?     @relation(fields: [taskId], references: [id])
  timeline   Timeline? @relation(fields: [timelineId], references: [id])
  user       User?     @relation(fields: [userId], references: [id])

  @@unique([categoryId, userId])
  @@unique([categoryId, spaceId])
  @@unique([categoryId, roleId])
  @@unique([categoryId, timelineId])
  @@unique([categoryId, fileId])
  @@unique([categoryId, taskId])
}

model Group {
  id           String        @id @default(uuid())
  seq          Int           @unique @default(autoincrement())
  createdAt    DateTime      @default(now()) @db.Timestamptz(6)
  updatedAt    DateTime?     @updatedAt @db.Timestamptz(6)
  removedAt    DateTime?     @db.Timestamptz(6)
  name         String
  label        String?
  serviceId    String
  tenantId     String
  associations Association[]
  service      Service       @relation(fields: [serviceId], references: [id])
  tenant       Tenant        @relation(fields: [tenantId], references: [id])
}

model Ground {
  id           String    @id @default(uuid())
  seq          Int       @unique @default(autoincrement())
  createdAt    DateTime  @default(now())
  updatedAt    DateTime? @updatedAt @db.Timestamptz(6)
  removedAt    DateTime? @db.Timestamptz(6)
  imageDepotId String?
  workspaceId  String    @unique
  imageDepot   Depot?    @relation(fields: [imageDepotId], references: [id])
  workspace    Workspace @relation(fields: [workspaceId], references: [id])
}

model Exercise {
  id           String    @id @default(uuid())
  seq          Int       @unique @default(autoincrement())
  createdAt    DateTime  @default(now())
  updatedAt    DateTime? @updatedAt @db.Timestamptz(6)
  removedAt    DateTime? @db.Timestamptz(6)
  duration     Int
  count        Int
  taskId       String    @unique
  description  String?
  imageDepotId String?
  name         String
  videoDepotId String?
  task         Task      @relation(fields: [taskId], references: [id])
}

model Service {
  id         String       @id @default(uuid())
  seq        Int          @unique @default(autoincrement())
  createdAt  DateTime     @default(now()) @db.Timestamptz(6)
  updatedAt  DateTime?    @updatedAt @db.Timestamptz(6)
  removedAt  DateTime?    @db.Timestamptz(6)
  label      String
  name       ServiceNames @unique
  categories Category[]
  groups     Group[]
}

model Association {
  id         String    @id @default(uuid())
  seq        Int       @unique @default(autoincrement())
  createdAt  DateTime  @default(now())
  updatedAt  DateTime? @updatedAt @db.Timestamptz(6)
  removedAt  DateTime? @db.Timestamptz(6)
  groupId    String
  userId     String?
  spaceId    String?
  timelineId String?
  roleId     String?
  fileId     String?
  contentId  String?
  taskId     String?
  content    Content?  @relation(fields: [contentId], references: [id])
  file       File?     @relation(fields: [fileId], references: [id])
  group      Group     @relation(fields: [groupId], references: [id])
  role       Role?     @relation(fields: [roleId], references: [id])
  space      Space?    @relation(fields: [spaceId], references: [id])
  task       Task?     @relation(fields: [taskId], references: [id])
  timeline   Timeline? @relation(fields: [timelineId], references: [id])
  user       User?     @relation(fields: [userId], references: [id])
}

model Profile {
  id        String    @id @default(uuid())
  seq       Int       @unique @default(autoincrement())
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt @db.Timestamptz(6)
  removedAt DateTime? @db.Timestamptz(6)
  name      String
  nickname  String    @unique
  userId    String
  depotId   String?
  depot     Depot?    @relation(fields: [depotId], references: [id])
  user      User      @relation(fields: [userId], references: [id])
}

model User {
  id             String          @id @default(uuid())
  seq            Int             @unique @default(autoincrement())
  updatedAt      DateTime?       @updatedAt @db.Timestamptz(6)
  createdAt      DateTime        @default(now()) @db.Timestamptz(6)
  removedAt      DateTime?       @db.Timestamptz(6)
  phone          String          @unique
  name           String          @unique
  password       String
  associations   Association[]
  classification Classification?
  profiles       Profile[]
  tenants        Tenant[]
}

model Tenant {
  id          String       @id @default(uuid())
  seq         Int          @unique @default(autoincrement())
  createdAt   DateTime     @default(now())
  updatedAt   DateTime?    @updatedAt @db.Timestamptz(6)
  removedAt   DateTime?    @db.Timestamptz(6)
  userId      String
  spaceId     String
  main        Boolean
  assignments Assignment[]
  categories  Category[]
  contents    Content[]
  files       File[]
  groups      Group[]
  roles       Role[]
  space       Space        @relation(fields: [spaceId], references: [id])
  user        User         @relation(fields: [userId], references: [id])
  timelines   Timeline[]
}

model Workspace {
  id               String    @id @default(uuid())
  seq              Int       @unique @default(autoincrement())
  createdAt        DateTime  @default(now()) @db.Timestamptz(6)
  updatedAt        DateTime? @updatedAt @db.Timestamptz(6)
  removedAt        DateTime? @db.Timestamptz(6)
  name             String
  label            String?
  address          String
  phone            String
  email            String
  businessNo       String    @unique
  logoImageDepotId String?   @unique
  spaceId          String    @unique
  ground           Ground?
  logoImageDepot   Depot?    @relation(fields: [logoImageDepotId], references: [id])
  space            Space     @relation(fields: [spaceId], references: [id])
}

model Space {
  id             String          @id @default(uuid())
  seq            Int             @unique @default(autoincrement())
  createdAt      DateTime        @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime?       @updatedAt @db.Timestamptz(6)
  removedAt      DateTime?       @db.Timestamptz(6)
  associations   Association[]
  classification Classification?
  tenants        Tenant[]
  workspace      Workspace?
}

model Timeline {
  id              String          @id @default(uuid())
  seq             Int             @unique @default(autoincrement())
  createdAt       DateTime        @default(now()) @db.Timestamptz(6)
  updatedAt       DateTime?       @updatedAt @db.Timestamptz(6)
  removedAt       DateTime?       @db.Timestamptz(6)
  tenantId        String
  associations    Association[]
  classifications Classification?
  sessions        Session[]
  tenant          Tenant          @relation(fields: [tenantId], references: [id])
}

model Session {
  id                 String              @id @default(uuid())
  seq                Int                 @unique @default(autoincrement())
  createdAt          DateTime            @default(now()) @db.Timestamptz(6)
  updatedAt          DateTime?           @updatedAt @db.Timestamptz(6)
  removedAt          DateTime?           @db.Timestamptz(6)
  type               SessionTypes        @default(ONE_TIME)
  repeatCycleType    RepeatCycleTypes?
  startDateTime      DateTime?           @db.Timestamptz(6)
  endDateTime        DateTime?           @db.Timestamptz(6)
  recurringDayOfWeek RecurringDayOfWeek?
  recurringMonth     Int?
  timelineId         String
  label              String
  name               String
  program            Program?
  timeline           Timeline            @relation(fields: [timelineId], references: [id])
}

model Program {
  id           String    @id @default(uuid())
  seq          Int       @unique @default(autoincrement())
  createdAt    DateTime  @default(now()) @db.Timestamptz(6)
  updatedAt    DateTime? @updatedAt @db.Timestamptz(6)
  removedAt    DateTime? @db.Timestamptz(6)
  routineId    String    @unique
  sessionId    String    @unique
  instructorId String
  capacity     Int
  routine      Routine   @relation(fields: [routineId], references: [id])
  session      Session   @relation(fields: [sessionId], references: [id])
}

model Activity {
  id        String    @id @default(uuid())
  seq       Int       @unique @default(autoincrement())
  createdAt DateTime  @default(now()) @db.Timestamptz(6)
  updatedAt DateTime? @updatedAt @db.Timestamptz(6)
  removedAt DateTime? @db.Timestamptz(6)
  routineId String
  taskId    String
  routine   Routine   @relation(fields: [routineId], references: [id])
  task      Task      @relation(fields: [taskId], references: [id])
}

model Routine {
  id         String     @id @default(uuid())
  seq        Int        @unique @default(autoincrement())
  createdAt  DateTime   @default(now()) @db.Timestamptz(6)
  updatedAt  DateTime?  @updatedAt @db.Timestamptz(6)
  removedAt  DateTime?  @db.Timestamptz(6)
  name       String
  label      String
  activities Activity[]
  program    Program?
}

model Task {
  id             String          @id @default(uuid())
  seq            Int             @unique @default(autoincrement())
  createdAt      DateTime        @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime?       @updatedAt @db.Timestamptz(6)
  removedAt      DateTime?       @db.Timestamptz(6)
  tenantId       String
  activities     Activity[]
  associations   Association[]
  classification Classification?
  exercise       Exercise?
}

model Role {
  id             String          @id @default(uuid())
  seq            Int             @unique @default(autoincrement())
  createdAt      DateTime        @default(now())
  updatedAt      DateTime?       @updatedAt @db.Timestamptz(6)
  removedAt      DateTime?       @db.Timestamptz(6)
  name           Roles           @default(USER)
  tenantId       String
  abilities      Ability[]
  assignments    Assignment[]
  associations   Association[]
  classification Classification?
  tenant         Tenant          @relation(fields: [tenantId], references: [id])
}

model Assignment {
  id        String    @id @default(uuid())
  seq       Int       @unique @default(autoincrement())
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt @db.Timestamptz(6)
  removedAt DateTime? @db.Timestamptz(6)
  roleId    String
  tenantId  String
  role      Role      @relation(fields: [roleId], references: [id])
  tenant    Tenant    @relation(fields: [tenantId], references: [id])
}

model Action {
  id         String         @id @default(uuid())
  seq        Int            @unique @default(autoincrement())
  createdAt  DateTime       @default(now())
  updatedAt  DateTime?      @updatedAt @db.Timestamptz(6)
  removedAt  DateTime?      @db.Timestamptz(6)
  name       AbilityActions @default(CREATE)
  conditions Json?
  tenantId   String
}

model Subject {
  id        String    @id @default(uuid())
  seq       Int       @unique @default(autoincrement())
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt @db.Timestamptz(6)
  removedAt DateTime? @db.Timestamptz(6)
  name      String    @unique
  tenantId  String
}

model Ability {
  id          String       @id @default(uuid())
  seq         Int          @unique @default(autoincrement())
  createdAt   DateTime     @default(now()) @db.Timestamptz(6)
  updatedAt   DateTime?    @updatedAt @db.Timestamptz(6)
  removedAt   DateTime?    @db.Timestamptz(6)
  type        AbilityTypes
  roleId      String
  description String?
  conditions  Json?
  subjectId   String
  tenantId    String
  role        Role         @relation(fields: [roleId], references: [id])
}

model Post {
  id        String    @id @default(uuid())
  seq       Int       @unique @default(autoincrement())
  createdAt DateTime  @default(now()) @db.Timestamptz(6)
  updatedAt DateTime? @updatedAt @db.Timestamptz(6)
  removedAt DateTime? @db.Timestamptz(6)
  contentId String
  content   Content   @relation(fields: [contentId], references: [id])
}

model Content {
  id           String        @id @default(uuid())
  seq          Int           @unique @default(autoincrement())
  createdAt    DateTime      @default(now()) @db.Timestamptz(6)
  updatedAt    DateTime?     @updatedAt @db.Timestamptz(6)
  removedAt    DateTime?     @db.Timestamptz(6)
  title        String?
  description  String?
  type         TextTypes     @default(Editor)
  text         String?       @db.VarChar(1000)
  depotId      String?
  tenantId     String
  associations Association[]
  depot        Depot?        @relation(fields: [depotId], references: [id])
  tenant       Tenant        @relation(fields: [tenantId], references: [id])
  posts        Post[]
}

model Depot {
  id        String     @id @default(uuid())
  seq       Int        @unique @default(autoincrement())
  createdAt DateTime   @default(now())
  updatedAt DateTime?  @updatedAt @db.Timestamptz(6)
  removedAt DateTime?  @db.Timestamptz(6)
  contents  Content[]
  files     File[]
  grounds   Ground[]
  profiles  Profile[]
  workspace Workspace?
}

model File {
  id             String          @id @default(uuid())
  seq            Int             @unique @default(autoincrement())
  name           String
  depotId        String
  size           Int
  mimeType       String
  url            String
  tenantId       String
  createdAt      DateTime        @default(now())
  updatedAt      DateTime?       @updatedAt @db.Timestamptz(6)
  removedAt      DateTime?       @db.Timestamptz(6)
  associations   Association[]
  classification Classification?
  depot          Depot           @relation(fields: [depotId], references: [id])
  tenant         Tenant          @relation(fields: [tenantId], references: [id])
}

enum SMSStatus {
  PROGRESS
  PENDING
  SENT
  FAILED
}

enum ReservationStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

enum SessionTypes {
  ONE_TIME
  ONE_TIME_RANGE
  RECURRING
}

enum RepeatCycleTypes {
  WEEKLY
  MONTHLY
}

enum SessionEndTypes {
  NEVER
  ON_DATE
  AFTER_OCCURRENCES
}

enum RecurringDayOfWeek {
  MONDAY
  TUESDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
  SATURDAY
  SUNDAY
}

enum AbilityActions {
  CREATE
  READ
  UPDATE
  DELETE
  ACCESS
}

enum AbilityTypes {
  CAN
  CAN_NOT
}

enum Roles {
  USER
  SUPER_ADMIN
  ADMIN
}

enum TemplateNames {
  WELCOME
  EMAIL_VERIFICATION
  RESET_PASSWORD
}

enum QnaStatus {
  OPEN
  CLOSED
}

enum TextTypes {
  Editor
  Input
  Textarea
}

enum CategoryTypes {
  LEAF
  ROOT
}

enum ServiceNames {
  user
  role
  space
  timeline
  file
  task
  program
}

enum DepotTypes {
  ROOT
  LEAF
}
